# =============================================================================
# Omnis Installer - Configuration GLF OS
# =============================================================================
# GLF OS - Gaming Linux FR
# Base: NixOS | Desktop: GNOME/KDE
# Source: https://www.gaminglinux.fr/glf-os/
# Repo: https://github.com/Gaming-Linux-FR/GLF-OS

version: "1.0"

# Theme directory (contains all branding assets)
# Path relative to this config file
theme: "../themes/glfos"

# -----------------------------------------------------------------------------
# Internationalization (i18n)
# -----------------------------------------------------------------------------
i18n:
  # Default locale at startup (must match a file in config/i18n/)
  default_locale: "en_US"
  # Available locales for user selection
  available_locales:
    - "en_US"
    - "fr_FR"
  # Fallback locale if selected locale is unavailable
  fallback_locale: "en_US"

# -----------------------------------------------------------------------------
# Branding - Identite visuelle officielle GLF OS
# -----------------------------------------------------------------------------
branding:
  # Identite
  name: "GLF OS"
  version: "Omnislash"
  edition: "25.04"
  tagline: "Linux Gaming made easy!"

  # Couleurs officielles (source: gaminglinux.fr)
  colors:
    primary: "#5597e6"      # Bleu GLF (titres, accents)
    secondary: "#4a8bd4"    # Bleu secondaire
    accent: "#5597e6"       # Accent (meme que primary)
    background: "#1a1a1a"   # Fond sombre
    surface: "#32373c"      # Surface elements/boutons
    text: "#fffded"         # Texte principal (cream)
    text_muted: "#9CA3AF"   # Texte secondaire
    # Status colors
    success: "#10B981"
    warning: "#F59E0B"
    error: "#EF4444"

  # Assets (chemins relatifs au theme directory)
  assets:
    logo: "logos/logo.png"
    logo_light: "logos/logo_light.png"
    logo_small: "logos/logo-64.png"
    logo_256: "logos/logo-256.png"
    background: "wallpapers/dark.jpg"
    background_alt: "wallpapers/frost-2-dark.png"
    icon: "logos/logo-256.png"
    bootloader: "boot/glf-bootloader.png"
    efi_icon: "boot/glf-efi.png"

  # Typographie
  fonts:
    primary: "Poppins"
    display: "Lemon Milk"
    monospace: "Roboto Mono"

# -----------------------------------------------------------------------------
# Jobs - Workflow d'installation NixOS
# -----------------------------------------------------------------------------
jobs:
  # Ecran d'accueil et verifications
  - name: welcome
    config:
      show_release_notes: true

      # Wallpapers for welcome screen (relative to theme directory)
      wallpapers:
        dark: "wallpapers/welcome-dark.jpg"
        light: "wallpapers/welcome-light.jpg"
        fallback: "wallpapers/dark.jpg"

      # Icons for requirement status (relative to theme directory)
      # These icons should be downloaded and placed in the theme
      icons:
        # Memory icons
        ram_pass: "icons/requirements/mem-pass.svg"
        ram_warn: "icons/requirements/mem-warn.svg"
        ram_fail: "icons/requirements/mem-fail.svg"
        # Disk icons
        disk_pass: "icons/requirements/hd-pass.svg"
        disk_warn: "icons/requirements/hd-warn.svg"
        disk_fail: "icons/requirements/hd-fail.svg"
        # GPU icons
        gpu_pass: "icons/requirements/gpu-pass.svg"
        gpu_warn: "icons/requirements/gpu-warn.svg"
        gpu_fail: "icons/requirements/gpu-fail.svg"

      # ---------------------------------------------------------------------
      # System Requirements Configuration
      # ---------------------------------------------------------------------
      requirements:
        # Memory (RAM)
        # Standard edition: 8 GB minimum, 16 GB recommended
        # Studio edition: 16 GB minimum, 32 GB recommended
        min_ram_gb: 8
        recommended_ram_gb: 16
        warn_ram_gb: 16  # Below this shows warning, above shows pass

        # Disk space
        min_disk_gb: 60
        recommended_disk_gb: 120
        require_ssd: false  # Recommended but not required

        # Boot requirements
        require_efi: true
        require_secure_boot_disabled: false

        # Connectivity
        require_internet: false
        recommend_internet: true

        # Power
        require_ac_power: false
        recommend_ac_power: true
        min_battery_percent: 20

        # CPU architecture
        require_x86_64: true

        # ---------------------------------------------------------------------
        # GPU Compatibility Configuration
        # ---------------------------------------------------------------------
        # Defines which GPU vendors are compatible and minimum models
        gpu:
          # Supported GPU vendors (can be any combination)
          # Values: AMD, INTEL, NVIDIA
          availability:
            - AMD
            - INTEL
            - NVIDIA

          # Require dedicated GPU (dGPU) for installation
          # If false, integrated graphics (iGPU) will show warning but allow install
          require_dedicated: false

          # Minimum GPU overrides by vendor
          # These define the minimum acceptable GPU model for each vendor
          # Models below these will fail the GPU check
          # See docs/gpu-compatibility.md for full model reference
          overrides:
            # NVIDIA: GeForce GTX 1650 and above
            # Architecture: Turing (TU117)
            # Minimum compute capability: 7.5
            nvidia: "GTX 1650"

            # AMD: RX 570 and above
            # Architecture: Polaris (GCN 4)
            # Leave empty for no minimum requirement
            amd: ""

            # Intel: UHD 630 and above (for iGPU)
            # Architecture: Coffee Lake
            # Leave empty for no minimum requirement
            intel: ""

  # Selection de la langue et region
  - name: locale
    config:
      default_language: "fr_FR"
      default_timezone: "Europe/Paris"
      show_keyboard_preview: true

  # Partitionnement
  - name: partition
    config:
      default_filesystem: ext4
      allow_encryption: true
      allow_manual_partitioning: true
      efi_partition_size_mb: 512
      swap_strategy: auto

  # Selection de la saveur (DE/Edition)
  - name: packages
    config:
      # Saveurs disponibles pour GLF OS
      flavors:
        - id: gnome
          name: "GLF OS GNOME"
          description: "Edition GNOME - Interface moderne et epuree"
          icon: "flavors/gnome.png"
          default: true
        - id: kde
          name: "GLF OS KDE"
          description: "Edition KDE Plasma - Personnalisation maximale"
          icon: "flavors/kde.png"
        - id: minimal
          name: "GLF OS Minimal"
          description: "Base minimale sans environnement de bureau"
          icon: "flavors/minimal.png"
      # Groupes de paquets optionnels
      optional_groups:
        - id: gaming
          name: "Gaming"
          description: "Steam, Lutris, Wine, Proton-GE, MangoHud"
          default: true
        - id: streaming
          name: "Streaming"
          description: "OBS Studio, plugins streaming"
        - id: emulation
          name: "Emulation"
          description: "RetroArch, Dolphin, PCSX2, RPCS3"

  # Installation du systeme (NixOS)
  - name: install
    config:
      source: "/iso/nixos"
      method: nixos-install
      preserve_permissions: true

  # Configuration utilisateur
  - name: users
    config:
      require_root_password: false
      default_shell: "/bin/bash"
      default_groups:
        - wheel
        - video
        - audio
        - storage
        - input  # Pour les manettes gaming

  # Bootloader
  - name: bootloader
    config:
      type: systemd-boot
      install_path: auto
      enable_os_prober: false  # NixOS gere son propre boot

  # Finalization
  - name: finished
    config:
      show_install_log: true
      auto_reboot_delay: 10

# -----------------------------------------------------------------------------
# Options avancees
# -----------------------------------------------------------------------------
advanced:
  log_level: info
  log_file: "/var/log/omnis-install.log"
  ipc_socket: "/run/omnis/ipc.sock"
  job_timeout: 3600
  debug_mode: false
